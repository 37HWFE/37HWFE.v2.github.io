<!DOCTYPE html><html lang="zh-cn"><head><meta charset="utf-8"><title>HTML/BODY背景渲染原理 | Ocean Team Blog</title><meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><meta name="format-detection" content="telephone=no"><meta name="author" content="[object Object]"><meta name="designer" content="minfive"><meta name="keywords" content="Ocean Team Blog"><meta name="description" content="Ocean Team Blog"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="format-detection" content="telephone=yes"><meta name="mobile-web-app-capable" content="yes"><meta name="robots" content="all"><link rel="canonical" href="https://37hwfe.github.io/2021/02/20/body-background-color-setting/index.html"><link rel="icon" type="image/png" href="/img/logo.png" sizes="32x32"><link rel="stylesheet" href="/scss/base/index.css"><link rel="alternate" href="/atom.xml" title="Ocean Team Blog" type="application/atom+xml"><link rel="stylesheet" href="/scss/views/page/post.css"><meta name="generator" content="Hexo 5.3.0"></head><body ontouchstart><div id="page-loading" class="page page-loading"><div class="wrap"><div class="k-line k-line11-1"></div><div class="k-line k-line11-2"></div><div class="k-line k-line11-3"></div><div class="k-line k-line11-4"></div><div class="k-line k-line11-5"></div></div></div><div id="page" class="page js-hidden"><header class="page__small-header page__header--small"><nav class="page__navbar"><div class="page__container navbar-container"><a class="page__logo" href="/" title="Ocean Team Blog" alt="Ocean Team Blog"><img src="/img/logo.png" alt="Ocean Team Blog"></a><nav class="page__nav"><ul class="nav__list clearfix"><li class="nav__item"><a href="/" alt="首页" title="首页">首页</a></li><li class="nav__item"><a href="/archives" alt="归档" title="归档">归档</a></li><li class="nav__item"><a href="/about" alt="关于" title="关于">关于</a></li></ul></nav><button class="page__menu-btn" type="button"><i class="iconfont icon-menu"></i></button></div></nav></header><main class="page__container page__main"><div class="page__content"><article class="page__post"><div class="post__cover"><img src="/images/2021/body-background-color-setting/cover.png" alt="HTML/BODY背景渲染原理"></div><header class="post__info"><h1 class="post__title">HTML/BODY背景渲染原理</h1><div class="post__mark"><div class="mark__block"><i class="mark__icon iconfont icon-write"></i><ul class="mark__list clearfix"><li class="mark__item"><a href="https://37hwfe.github.io/">oceanTeam</a></li></ul></div><div class="mark__block"><i class="mark__icon iconfont icon-time"></i><ul class="mark__list clearfix"><li class="mark__item"><span>2021-02-20</span></li></ul></div><div class="mark__block"><i class="mark__icon iconfont icon-tab"></i><ul class="mark__list clearfix"><li class="mark__item"><a href="/tags/CSS/">CSS</a></li><li class="mark__item"><a href="/tags/Background/">Background</a></li><li class="mark__item"><a href="/tags/HTML/">HTML</a></li></ul></div><div class="mark__block"><i class="mark__icon iconfont icon-eye"></i><ul class="mark__list clearfix"><li id="busuanzi_container_page_pv" class="mark__item"><span id="busuanzi_value_page_pv"></span>次</li></ul></div></div></header><div class="post__content"><h3 id="一、前言"><a href="#一、前言" class="headerlink" title="一、前言"></a>一、前言</h3><p><font color="#f66"><strong>结论先行：</strong></font></p><p>我们给body设置背景色，实际我们看见的未必是body上的背景色：</p><ol><li><font color="#42b983">当html标签没有设置背景色时，我们看见的是作用在浏览器画布上的背景色，不是body上的；</font></li><li>当html标签被设置了背景色时，我们看见的是真正作用在body上的背景色。</li></ol><p>人在前端已经漂泊数年，机缘巧合才发现，这几年给body写的背景色，全被浏览器给「吃」了。文中涉及的是<font color="#42b983">CSS中关于特殊元素（html/body）的背景渲染的原理</font>，对你而言它也许是块新大陆，也可能，你早已熟知，那么正好···可以一起交流下？</p><h3 id="二、一个情景"><a href="#二、一个情景" class="headerlink" title="二、一个情景"></a>二、一个情景</h3><p>有一个渲染列表的页面（不定高），要求<font color="#f66">背景是渐变颜色</font>，效果如下图：<br><img src="https://user-gold-cdn.xitu.io/2018/5/29/163ac1f6e90bdee3?w=1160&h=652&f=jpeg&s=43504"><br><strong>需求很简单：</strong></p><ul><li>列表内容不足以撑满一屏时，整屏背景以渐变色填充；</li><li>列表内容超过一屏高度时，整个页面背景以渐变色填充；</li></ul><h3 id="三、情景破解"><a href="#三、情景破解" class="headerlink" title="三、情景破解"></a>三、情景破解</h3><p><font color="#f66">姿势有很多，偏爱的只有妳这一种。</font></p><p>PS：破解情景的解法有很多，而下面这种解法可以引起我们关于html、body背景渲染原理的思考。</p><h5 id="Step-1：首先给body设置颜色渐变"><a href="#Step-1：首先给body设置颜色渐变" class="headerlink" title="Step 1：首先给body设置颜色渐变"></a>Step 1：首先给body设置颜色渐变</h5><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">body</span>&#123; <span class="attribute">background</span>: <span class="built_in">linear-gradient</span>(#FFFAD0,#ffffff); &#125;</span><br></pre></td></tr></table></figure><p>不出意外，页面渐变出现了断层👇<br><img src="https://user-gold-cdn.xitu.io/2018/5/29/163ac28b30125a81?w=1156&h=652&f=jpeg&s=45796"></p><h5 id="Step-2：设置html高度为100-，同时给body设置下min-height"><a href="#Step-2：设置html高度为100-，同时给body设置下min-height" class="headerlink" title="Step 2：设置html高度为100%，同时给body设置下min-height"></a>Step 2：设置html高度为100%，同时给body设置下min-height</h5><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">html</span>&#123; <span class="attribute">height</span>: <span class="number">100%</span>;&#125;</span><br><span class="line"><span class="selector-tag">body</span>&#123; <span class="attribute">min-height</span>: <span class="number">100%</span>; <span class="attribute">background</span>: <span class="built_in">linear-gradient</span>(#FFFAD0,#ffffff); &#125;</span><br></pre></td></tr></table></figure><p>又不出意外，看起来很OJBK，没有出现断层了！</p><p>突然，内容渐渐多了起来，超过一屏的高度了···👇<br><img src="https://user-gold-cdn.xitu.io/2018/5/29/163ac2dfb7e1e4fe?w=1156&h=648&f=jpeg&s=62578"></p><p>呃···这是什么情况？超过一屏之后又断层了！[what the fuck &amp; 掀桌].jpg</p><h5 id="Step3：设置html的背景色"><a href="#Step3：设置html的背景色" class="headerlink" title="Step3：设置html的背景色"></a>Step3：设置html的背景色</h5><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">html</span>&#123; <span class="attribute">height</span>: <span class="number">100%</span>; <span class="attribute">background</span>: red; &#125;</span><br></pre></td></tr></table></figure><p>是的，你没看错，我给html设置了红色！不得不服气，这样的骚操作竟然解决了上面断层的问题。</p><h5 id="突然兴起的总结"><a href="#突然兴起的总结" class="headerlink" title="突然兴起的总结"></a>突然兴起的总结</h5><p><font color="#f66"><strong>小小梳理下我们遇到的疑点：</strong></font></p><ol><li>首先我们给body设置了渐变色，即使内容超过一屏，我们看到的也应该是body那一层，即是渐变色的背景，不应该断层！</li><li>为什么给html元素设置一个背景色就可以完美解决这个断层？</li></ol><h3 id="四、原理解析"><a href="#四、原理解析" class="headerlink" title="四、原理解析"></a>四、原理解析</h3><p>我们这个问题涉及到了三个对象：<font color="#42b983">html元素、body元素和浏览器画布</font>，我们需要了解它们三者之间渲染背景色的机制。</p><blockquote><p>The document canvas is the infinite surface over which the document is rendered. [CSS2] Since no element corresponds to the canvas, in order to allow styling of the canvas CSS propagates the background of the root element (or, in the case of HTML, the</p><body>element) as described below. However, if no boxes are generated for the element whose background would be used for the canvas (for example, if the root element has display: none), then the canvas background is transparent.<p></p></body></blockquote><blockquote><p>The background of the root element becomes the background of the canvas and its background painting area extends to cover the entire canvas. However, any images are sized and positioned relative to the root element as if they were painted for that element alone. (In other words, the background positioning area is determined as for the root element.) The root element does not paint this background again, i.e., the used value of its background is transparent.</p></blockquote><p>以上是w3c对特定元素（根元素）背景的定义说明，总结为以下两点：</p><ul><li><font color="#42b983">CSS根据根元素（html/body）给文档画布（该画布是无限大的，我们姑且理解为浏览器画布）渲染背景颜色，同时背景色的定位区域就是根元素的区域；</font></li><li>根元素不再绘制该背景色，即根元素背景的使用值是透明的。</li></ul><p>基于这两点解答前面我们的疑问：</p><h5 id="1、给body设置了渐变色背景，内容超过一屏的时候，出现了断层"><a href="#1、给body设置了渐变色背景，内容超过一屏的时候，出现了断层" class="headerlink" title="1、给body设置了渐变色背景，内容超过一屏的时候，出现了断层"></a>1、给body设置了渐变色背景，内容超过一屏的时候，出现了断层</h5><p>真相是，浏览器画布首先获取根节点的背景样式，由于html我们没有设置，所以它获取了body的背景色，从而导致浏览器画布也是渐变色背景；</p><p>其次，浏览器画布背景色的定位区域取决于根元素的区域，这里的根元素是html，而我们对html做了 height:100% 的设置。所以浏览器画布以该区域的背景色重复渲染。</p><p>用图举证：<br>给html设置50%的width，那么左侧看到的是我们的页面dom内容，右侧则是浏览器画布</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">html</span>&#123; <span class="attribute">height</span>: <span class="number">100%</span>; <span class="attribute">width</span>: <span class="number">50%</span>; &#125;</span><br><span class="line"><span class="selector-tag">body</span>&#123; <span class="attribute">min-height</span>: <span class="number">100%</span>; <span class="attribute">background</span>: <span class="built_in">linear-gradient</span>(#FFFAD0,#ffffff); &#125;</span><br></pre></td></tr></table></figure><p><img src="https://user-gold-cdn.xitu.io/2018/5/30/163aecafb284ec93?w=1158&h=650&f=jpeg&s=51375"><br>可以发现，左右两侧的背景色是一致的：<br><img src="https://user-gold-cdn.xitu.io/2018/5/30/163aeceb4cbf2782?w=1156&h=654&f=jpeg&s=63084"><br><font color="#f66">证明了浏览器画布取了body的背景色进行渲染，而body的背景色其实是透明值，必然地，我们在body看见的是会断层的渐变色。</font></p><p><font color="#f66"><strong>所以，我们给body设置的背景色被浏览器画布吃掉了!</strong></font></p><h5 id="2、通过html设置背景色的方式解决了断层问题"><a href="#2、通过html设置背景色的方式解决了断层问题" class="headerlink" title="2、通过html设置背景色的方式解决了断层问题"></a>2、通过html设置背景色的方式解决了断层问题</h5><p>我们给html设置背景色，其实是<font color="#f66">让html去承担被浏览器画布取色的任务，这时候body的值就是我们设置的渐变色</font>。以图举证：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">html</span>&#123; <span class="attribute">height</span>: <span class="number">100%</span>; <span class="attribute">width</span>: <span class="number">50%</span>; <span class="attribute">background</span>: <span class="number">#42b983</span>; &#125;</span><br></pre></td></tr></table></figure><p><img src="https://user-gold-cdn.xitu.io/2018/5/30/163aed8393d1d212?w=1160&h=652&f=jpeg&s=61155"><br>对的，红色不喜欢，我决定了换成vue的主题绿。如此，浏览器画布取了html的背景色，左侧就可以正常看见body的渐变背景了。</p><h3 id="五、结语"><a href="#五、结语" class="headerlink" title="五、结语"></a>五、结语</h3><p>以上提及的知识点也许很基础，它只是w3c里面关于背景渲染的标准，只不过被我们很多人忽略而已。现在踩坑，记之共勉。</p><p><strong>原文链接：</strong><a target="_blank" rel="noopener" href="https://juejin.im/post/5b0d52e5f265da092918d902">天呐！我给body设置的背景色被浏览器吃掉了！</a></p><p><strong>参考</strong></p><p><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/10947541/applying-a-background-to-html-and-or-body">Applying a background to<html>and/or<body></body></html></a></p><p><a target="_blank" rel="noopener" href="https://www.w3.org/TR/css-backgrounds-3/#special-backgrounds">Backgrounds of Special Elements</a></p><div class="post-announce">感谢您的阅读，本文由 <a href="https://37hwfe.github.io">Ocean Team Blog</a> 版权所有。如若转载，请注明出处：Ocean Team Blog（<a href="/2021/02/20/body-background-color-setting/">http://www.37oct.cn/2021/02/20/body-background-color-setting/</a>）</div><div class="post__prevs"><div class="post__prev"><a href="/2021/02/20/auto-ps-cut-image-function/" title="解放双手-ps自动切图脚本"><i class="iconfont icon-prev"></i>解放双手-ps自动切图脚本</a></div><div class="post__prev post__prev--right"><a href="/2021/02/20/http-memory-cache/" title="http 文件缓存机制">http 文件缓存机制<i class="iconfont icon-next"></i></a></div></div></div></article><div id="comment-container"></div></div><aside class="page__sidebar"><form id="page-search-from" class="page__search-from" action="/search/"><label class="search-form__item"><input class="input" type="text" name="search" placeholder="Search..."> <i class="iconfont icon-search"></i></label></form><div class="sidebar__block"><h3 class="block__title">简介</h3><p class="block__text">Ocean Team Blog</p></div><div class="sidebar__block"><h3 class="block__title">文章分类</h3><ul class="block-list"><li class="block-list-item"><a class="block-list-link" href="/categories/%E8%B5%84%E6%BA%90%E5%B7%A5%E5%85%B7/">资源工具</a><span class="block-list-count">1</span></li><li class="block-list-item"><a class="block-list-link" href="/categories/%E5%89%8D%E7%AB%AF%E7%9F%A5%E8%AF%86/">前端知识</a><span class="block-list-count">1</span></li><li class="block-list-item"><a class="block-list-link" href="/categories/JavaScript/">JavaScript</a><span class="block-list-count">2</span></li><li class="block-list-item"><a class="block-list-link" href="/categories/CSS3/">CSS3</a><span class="block-list-count">1</span></li></ul></div><div class="sidebar__block"><h3 class="block__title">最新文章</h3><ul class="block-list latest-post-list"><li class="latest-post-item"><a href="/2021/02/20/http-memory-cache/" title="http 文件缓存机制"><div class="item__cover"><img src="/images/2021/http-memory-cache/cover.png" alt="http 文件缓存机制"></div><div class="item__info"><h3 class="item__title">http 文件缓存机制</h3><span class="item__text">2021-02-20</span></div></a></li><li class="latest-post-item"><a href="/2021/02/20/body-background-color-setting/" title="HTML/BODY背景渲染原理"><div class="item__cover"><img src="/images/2021/body-background-color-setting/cover.png" alt="HTML/BODY背景渲染原理"></div><div class="item__info"><h3 class="item__title">HTML/BODY背景渲染原理</h3><span class="item__text">2021-02-20</span></div></a></li><li class="latest-post-item"><a href="/2021/02/20/auto-ps-cut-image-function/" title="解放双手-ps自动切图脚本"><div class="item__cover"><img src="/images/2021/auto-ps-cut-image-function/cover.png" alt="解放双手-ps自动切图脚本"></div><div class="item__info"><h3 class="item__title">解放双手-ps自动切图脚本</h3><span class="item__text">2021-02-20</span></div></a></li><li class="latest-post-item"><a href="/2021/02/20/what-is-react/" title="当我们谈论React时，我们谈论些什么？"><div class="item__cover"><img src="/images/2021/what-is-react/cover.png" alt="当我们谈论React时，我们谈论些什么？"></div><div class="item__info"><h3 class="item__title">当我们谈论React时，我们谈论些什么？</h3><span class="item__text">2021-02-20</span></div></a></li></ul></div><div class="sidebar__block"><h3 class="block__title">文章标签</h3><ul class="block-list tag-list clearfix"><li class="tag-item"><a class="tag-link" href="/tags/Background/">Background</a></li><li class="tag-item"><a class="tag-link" href="/tags/CSS/">CSS</a></li><li class="tag-item"><a class="tag-link" href="/tags/HTML/">HTML</a></li><li class="tag-item"><a class="tag-link" href="/tags/JavaScript/">JavaScript</a></li><li class="tag-item"><a class="tag-link" href="/tags/React/">React</a></li><li class="tag-item"><a class="tag-link" href="/tags/ps%E8%87%AA%E5%8A%A8%E5%88%87%E5%9B%BE/">ps自动切图</a></li><li class="tag-item"><a class="tag-link" href="/tags/%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD/">前端性能</a></li><li class="tag-item"><a class="tag-link" href="/tags/%E8%B5%84%E6%BA%90%E5%B7%A5%E5%85%B7/">资源工具</a></li></ul></div></aside></main><footer class="page__footer"><section class="footer__top"><div class="page__container footer__container"><div class="footer-top__item footer-top__item--2"><h3 class="item__title">关于</h3><div class="item__content"><p class="item__text">主要用于分享37海外前端Ocean团队日常学习、交流、输出</p><ul class="footer__contact-info"><li class="contact-info__item"><i class="iconfont icon-address"></i> <span>Guangzhou, Guangdong Province, China</span></li><li class="contact-info__item"><i class="iconfont icon-email2"></i> <span>zhouguilin@gm99.com</span></li></ul></div></div></div></section><section class="footer__bottom"><div class="page__container footer__container"><p class="footer__copyright">© <a href="https://github.com/Mrminfive/hexo-theme-skapp" target="_blank">Skapp</a> 2017 powered by <a href="http://hexo.io/" target="_blank">Hexo</a>, made by <a href="https://github.com/Mrminfive" target="_blank">minfive</a>.</p><ul class="footer__social-network clearfix"></ul></div></section></footer><div id="back-top" class="back-top back-top--hidden js-hidden"><i class="iconfont icon-top"></i></div></div><script src="/js/page/post.js"></script><link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css"><script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script><script src="/js/md5.min.js"></script><script>var tags=["CSS","Background","HTML"],gitalk=new Gitalk({clientID:"b397f402965c6c098926",clientSecret:"e08101d873dff990f632042a1295d7d1bc87d3a1",repo:"37HWFE.v2.github.io",owner:"37HWFE",admin:["37HWFE"],labels:tags,id:new Date(1613803591e3).getTime()>new Date("2018-02-15").getTime()?md5(location.href):location.href});gitalk.render("comment-container")</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="/js/common/utils.js"></script><script src="/js/common/pack.js"></script><script src="/js/common/animation.js"></script><script src="/js/layout/loading.js"></script><script src="/js/layout/header.js"></script><script src="/js/layout/back-top.js"></script><script src="/js/layout/post.js"></script></body></html>